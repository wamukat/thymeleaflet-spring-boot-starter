<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<body>

<!--
/**
 * Storybook使用例表示フラグメント
 * 
 * フラグメントの使用例コードをシンタックスハイライト付きで表示する。
 * エラー状態と正常状態の両方に対応し、コメント行とHTML行を適切に色分けする。
 * 
 * @fragment renderUsage - 使用例表示フラグメント
 * @param hasError {@code Boolean} [optional=false] エラー状態フラグ
 * @param errorMessage {@code String} [optional] エラーメッセージ (hasError=trueの場合に必要)
 * @param usageExample {@code String} [required] 表示する使用例コード
 * 
 * @example
 * // 基本的な使用例 (正常状態)
 * <div th:with="usageExample='&lt;div th:replace=~{template :: fragment()}&gt;&lt;/div&gt;'"
 *      th:replace="~{thymeleaflet/fragments/usage-example :: renderUsage()}"></div>
 * 
 * @example
 * // エラー状態での使用例
 * <div th:with="hasError=true, errorMessage='Template not found', usageExample='&lt;!-- Error example --&gt;'"
 *      th:replace="~{thymeleaflet/fragments/usage-example :: renderUsage()}"></div>
 * 
 * @example
 * // 複数行コードでの使用例
 * <div th:with="usageExample='&lt;!-- コメント --&gt;\n&lt;div th:replace=~{template :: fragment()}&gt;&lt;/div&gt;'"
 *      th:replace="~{thymeleaflet/fragments/usage-example :: renderUsage()}"></div>
 */
-->
<div th:fragment="renderUsage">
    <div th:replace="~{thymeleaflet/fragments/usage-code-block :: codeBlock(${usageExample}, 'html', true, '', ${hasError ?: false}, ${errorMessage ?: ''}, 'usage-example')}"></div>

    <div th:if="${usageModel != null and !#maps.isEmpty(usageModel)}" class="mt-3">
        <div class="text-xs font-semibold tracking-wide text-emerald-700 bg-emerald-50 inline-flex px-2 py-1 rounded">MODEL</div>
        <div class="mt-2 space-y-2">
            <div th:each="entry : ${usageModel}" class="py-2 px-3 bg-gray-50 rounded">
                <div class="text-sm font-mono text-gray-800"
                     th:if="${entry.value instanceof T(java.util.Map)}"
                     th:utext="${entry.key + ' = {<br>' + #strings.arrayJoin(entry.value.entrySet().![ '&nbsp;&nbsp;' + key + '=' + (value != null ? value.toString() : 'null') ], ',<br>') + '<br>}'}">memberProfile = {</div>
                <div class="text-sm font-mono text-gray-800 whitespace-pre-wrap"
                     th:unless="${entry.value instanceof T(java.util.Map)}"
                     th:text="|${entry.key} = ${entry.value}|">key = value</div>
            </div>
        </div>
    </div>
</div>

</body>
</html>
